module InterfazInterpolacion where

import FuncionesInterfaz
import Interpolacion
import GraficosFunciones
import GramaticaConcreta
import UU.Parsing
import Graphics.UI.Gtk
import Foreign

interpolacion :: IO Table
interpolacion =  do 
                   table <- tableNew 9 1 False
                   tableSetColSpacings table 10
                   content <- vBoxNew False 0
                   datosx <- hBoxNew False 3
                   datosy <- hBoxNew False 3
                   num <- hBoxNew False 3
                   tableAttachDefaults table content 0 1 0 1

                   labelx <- labelNew  (Just "Ingrese los valores de las x separados por espacios")
                   puntosx <- entryNew
                   boxPackStart datosx labelx PackNatural 5
                   boxPackStart datosx puntosx PackNatural 5
                   boxPackStart content datosx PackNatural 5

                   labely <- labelNew  (Just "Ingrese los valores de los f(x) separados por espacios")             
                   puntosy <- entryNew
                   boxPackStart datosy labely  PackNatural 5
                   boxPackStart datosy puntosy  PackNatural 5
                   boxPackStart content datosy PackNatural 5

                   labelvx <- labelNew  (Just "Ingrese el valor en donde desea evaluar el polinomio")   
                   valorx <- entryNew
                   boxPackStart num labelvx  PackNatural 5
                   boxPackStart num valorx PackNatural 5
                   boxPackStart content num PackNatural 5

                   salida  <- entryNew
                   boxPackStart content salida PackNatural 5
                   eval <- buttonNewWithLabel "Evaluar"
                   boxPackStart content eval  PackNatural 0
                   graficar <- buttonNewWithLabel "Graficar"
                   boxPackStart content graficar  PackNatural 0
                   ayuda <- buttonNewWithLabel "Necesitas ayuda?"
                   boxPackStart content ayuda  PackNatural 0

                   {-NEWTON-}
                   newtoninter <- hBoxNew False 25
                   option <- vBoxNew False 0
                   tableAttachDefaults table newtoninter 0 1 2 3
                   radio1 <- radioButtonNewWithLabel "Interpolar con newton "
                   boxPackStart option radio1 PackNatural 5
                   boxPackStart newtoninter option PackNatural 0

                   {-LAGRANCE-}
                   lagrance <- hBoxNew False 25
                   option <- vBoxNew False 0
                   tableAttachDefaults table  lagrance 0 1 3 4
                   radio2 <- radioButtonNewWithLabelFromWidget radio1 "Interpolar con Lagrance "
                   boxPackStart option radio2 PackNatural 5
                   boxPackStart lagrance option PackNatural 0
                   
                   {-LINEALES-}
                   linealinter <- hBoxNew False 25
                   option <- vBoxNew False 0
                   tableAttachDefaults table linealinter 0 1 4 5
                   radio3 <-radioButtonNewWithLabelFromWidget radio2 "Interpolar con trazadores lineales "
                   boxPackStart option radio3 PackNatural 5
                   boxPackStart linealinter option PackNatural 0
                   
                   
                   {-CUADRATICOS-}
                   cuadraticointer <- hBoxNew False 25
                   option <- vBoxNew False 0
                   tableAttachDefaults table cuadraticointer 0 1 5 6
                   radio4 <- radioButtonNewWithLabelFromWidget radio3 "Interpolar con trazadores cuadráticos "
                   boxPackStart option radio4 PackNatural 5
                   boxPackStart cuadraticointer option PackNatural 0
                 
                    
                   {-CUBICO-}
                   cubicointer <- hBoxNew False 25
                   option <- vBoxNew False 0
                   tableAttachDefaults table cubicointer 0 1 6 7
                   radio5 <- radioButtonNewWithLabelFromWidget radio4 " Interpolar con trazadores cúbicos"
                   boxPackStart option radio5 PackNatural 5
                   boxPackStart cubicointer option PackNatural 0
                   
                   onClicked eval $ do
                                      px <- get puntosx entryText 
                                      listx <- parseIO pListDouble (funScanTxt px)
                                      py <- get puntosy entryText 
                                      listy <- parseIO pListDouble (funScanTxt py)
                                      v <- get valorx entryText 
                                      valorx <- parseIO pDouble (funScanTxt v)
                                      let result = newtonEvaluado listx listy valorx
                                      set salida [entryText := show(result)]
                                      
                          
                   
                   return table

                          